/**
 * Created by Gamer on 8/11/2015.
 */

module.exports = (function(){

    console.log("Creating communicator module");

    var socketIO;
    var listeners = {};

    function sendAll( name, msg ) {

        socketIO.emit( name, msg );

    }

    function setSocketIO( io ) {

        socketIO = io;

    }

    function registerListener ( name, f ) {

        listeners[ name ] = f;
        console.log("COMMUNICATOR: Registering listener on "+name);

    }

    function addAllListenersToClient( c ) {

        console.log("COMMUNICATOR: Registering listeners for "+ c.id);
        for( var name in listeners ) {

            c.on( name, listeners[name] );

        }

    }

    return {

        sendAll: sendAll,
        setSocketIO: setSocketIO,
        registerListener: registerListener,
        addAllListenersToClient: addAllListenersToClient

    }

})();